---
# tasks file for rsyslog
- name: Ensure rsyslog package is installed
  apt:
    name: '{{ rsyslog_package }}'
    state: present

- name: Ensure rsyslog.d subdirectory exists
  file:
    path: /etc/rsyslog.d
    state: directory
    owner: root
    group: root
    mode: 0755

#- name: Prevent duplicite log messages on Ubuntu distribution
#  file:
#    path: /etc/rsyslog.d/{{ item }}
#    state: absent
#  with_items:
#    - 20-ufw.conf
#    - 50-default.conf
#  when: ansible_distribution == 'Ubuntu'
#
#- name: Upload rsyslog configuration
#  template:
#    src: rsyslog.conf.j2
#    dest: /etc/rsyslog.conf
#    owner: root
#    group: root
#    mode: 0644
#    validate: '/usr/sbin/rsyslogd -N1 -f %s'
#  notify: Restart rsyslog

- name: Setup rsyslog logrotate
  include_tasks: logrotate.yml
